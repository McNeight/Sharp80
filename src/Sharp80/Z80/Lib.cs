/// Sharp 80 (c) Matthew Hamilton
/// Licensed Under GPL v3. See license.txt for details.

using System;
using System.Collections.Generic;

namespace Sharp80.Z80
{
    public class Lib
    {
        public static ushort CombineBytes(byte lowOrderByte, byte highOrderByte) => (ushort)(lowOrderByte | (highOrderByte << 8));
        public static string GetSpacedHex(IReadOnlyList<byte> memory, ushort index, int count)
        {
            switch (count)
            {
                case 0:
                    return "           ";
                case 1:
                    return $"{memory[index]:X2}         ";
                case 2:
                    return $"{memory[index]:X2} {memory[(index + 1) & 0xFFFF]:X2}      ";
                case 3:
                    return $"{memory[index]:X2} {memory[(index + 1) & 0xFFFF]:X2} {memory[(index + 2) & 0xFFFF]:X2}   ";
                case 4:
                    return $"{memory[index]:X2} {memory[(index + 1) & 0xFFFF]:X2} {memory[(index + 2) & 0xFFFF]:X2} {memory[(index + 3) & 0xFFFF]:X2}";
                default:
                    throw new Exception("GetSpacedHex: Too many bytes");
            }
        }
        public static ushort HexToUShort(string input) => ushort.Parse(input,
                                                                       System.Globalization.NumberStyles.AllowHexSpecifier,
                                                                       System.Globalization.CultureInfo.InvariantCulture);

        // These tables reflect the conditions of the input:
        // S: Bit 7 is set           --> 0x80
        // Z: input is zero          --> 0x40
        // 5: Bit 5 is set           --> 0x20
        // 3: Bit 3 is set           --> 0x08
        // P: input has even parity  --> 0x04

        internal static readonly byte[] SZ =
        {
            0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
            0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,
            0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,
            0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,
            0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,
            0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,
            0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,
            0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,
            0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80
        };

        internal static readonly byte[] SZ53P =
        {
            0x44,0x00,0x00,0x04,0x00,0x04,0x04,0x00,0x08,0x0C,0x0C,0x08,0x0C,0x08,0x08,0x0C,
            0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,0x0C,0x08,0x08,0x0C,0x08,0x0C,0x0C,0x08,
            0x20,0x24,0x24,0x20,0x24,0x20,0x20,0x24,0x2C,0x28,0x28,0x2C,0x28,0x2C,0x2C,0x28,
            0x24,0x20,0x20,0x24,0x20,0x24,0x24,0x20,0x28,0x2C,0x2C,0x28,0x2C,0x28,0x28,0x2C,
            0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,0x0C,0x08,0x08,0x0C,0x08,0x0C,0x0C,0x08,
            0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,0x08,0x0C,0x0C,0x08,0x0C,0x08,0x08,0x0C,
            0x24,0x20,0x20,0x24,0x20,0x24,0x24,0x20,0x28,0x2C,0x2C,0x28,0x2C,0x28,0x28,0x2C,
            0x20,0x24,0x24,0x20,0x24,0x20,0x20,0x24,0x2C,0x28,0x28,0x2C,0x28,0x2C,0x2C,0x28,
            0x80,0x84,0x84,0x80,0x84,0x80,0x80,0x84,0x8C,0x88,0x88,0x8C,0x88,0x8C,0x8C,0x88,
            0x84,0x80,0x80,0x84,0x80,0x84,0x84,0x80,0x88,0x8C,0x8C,0x88,0x8C,0x88,0x88,0x8C,
            0xA4,0xA0,0xA0,0xA4,0xA0,0xA4,0xA4,0xA0,0xA8,0xAC,0xAC,0xA8,0xAC,0xA8,0xA8,0xAC,
            0xA0,0xA4,0xA4,0xA0,0xA4,0xA0,0xA0,0xA4,0xAC,0xA8,0xA8,0xAC,0xA8,0xAC,0xAC,0xA8,
            0x84,0x80,0x80,0x84,0x80,0x84,0x84,0x80,0x88,0x8C,0x8C,0x88,0x8C,0x88,0x88,0x8C,
            0x80,0x84,0x84,0x80,0x84,0x80,0x80,0x84,0x8C,0x88,0x88,0x8C,0x88,0x8C,0x8C,0x88,
            0xA0,0xA4,0xA4,0xA0,0xA4,0xA0,0xA0,0xA4,0xAC,0xA8,0xA8,0xAC,0xA8,0xAC,0xAC,0xA8,
            0xA4,0xA0,0xA0,0xA4,0xA0,0xA4,0xA4,0xA0,0xA8,0xAC,0xAC,0xA8,0xAC,0xA8,0xA8,0xAC
        };

        internal static readonly byte[] SZ53 =
        {
            0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
            0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,
            0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
            0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,
            0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,
            0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,
            0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,
            0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0xA8,0xA8,0xA8,0xA8,0xA8,0xA8,0xA8,0xA8,
            0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0xA8,0xA8,0xA8,0xA8,0xA8,0xA8,0xA8,0xA8,
            0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,
            0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x88,0x88,0x88,0x88,0x88,0x88,0x88,0x88,
            0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0xA8,0xA8,0xA8,0xA8,0xA8,0xA8,0xA8,0xA8,
            0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0xA0,0xA8,0xA8,0xA8,0xA8,0xA8,0xA8,0xA8,0xA8
        };

        internal static readonly byte[] F53 =
        {
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
            0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,
            0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
            0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,
            0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
            0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,
            0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
            0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x08,0x08,0x08,0x08,0x08,0x08,0x08,0x08,
            0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28,
            0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x28,0x28,0x28,0x28,0x28,0x28,0x28,0x28
        };

        internal static readonly byte[] P =
        {
            0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,
            0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,
            0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,
            0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,
            0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,
            0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,
            0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,
            0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,
            0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,
            0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,
            0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,
            0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,
            0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,
            0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,
            0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04,0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,
            0x04,0x00,0x00,0x04,0x00,0x04,0x04,0x00,0x00,0x04,0x04,0x00,0x04,0x00,0x00,0x04
        };
    }
}
